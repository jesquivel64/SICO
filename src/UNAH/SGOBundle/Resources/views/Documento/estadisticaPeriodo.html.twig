{% extends "UNAHSGOBundle::layout.html.twig" %}
{% block content %}
<div class="row-fluid">
<section class="span12">
    <hgroup class="page-header">
      <h1>Estad&iacute;sticas <small> del {{ inicio|date("d/m/Y") }} al {{ fin|date("d/m/Y") }}</small></h1>
    </hgroup>
  </section>
</div>
<div class="row-fluid">
  <article class="span6">
    <hgroup class="page-header">
      <h2>Estad&iacute;sticas Generales de Documentos</h2>
    </hgroup>
    <canvas id="flujo" width="400" height="400"></canvas>
    <p>Recibidos: {{ recibidos }}</p>
    <p>Respondidos: {{ respondidos }}</p>
    <p>Enviados: {{ enviados }}</p>
  </article>
  <article class="span6">
    <hgroup class="page-header">
      <h2>Relaci&oacute;n entre Recibidos y Respondidos</h2>
    </hgroup>
    <canvas id="eficiencia" width="400" height="400"></canvas>
    <p>Respondidos: {{ respondidos }}</p>
    <p>No Respondidos: {{ noRespondidos }}</p>
  </article>
</div>
<div class="row-fluid">
  <article class="span6">
    <hgroup class="page-header">
      <h2>Documentos Recibidos por Dependencia</h2>
    </hgroup>
    <canvas id="dependencias" width="400" height="400"></canvas>
    {% for dato in emisor %}
    <p>{{ dato.nombre }}: {{ dato.cantidad }}</p>
    {% endfor %}
  </article>
</div>
<div class="row-fluid">
  <article class="span6">
    <hgroup class="page-header">
      <h2>Documentos Enviados por Tipo</h2>
    </hgroup>
    <canvas id="tipo" width="400" height="400"></canvas>
    {% for dato in tipo %}
    <p>{{ dato.nombre }}: {{ dato.cantidad }}</p>
    {% endfor %}
  </article>
  <article class="span6">
    <hgroup class="page-header">
      <h2>Documentos Recibidos por Tipo</h2>
    </hgroup>
    <canvas id="tipo-recibido" width="400" height="400"></canvas>
    {% for dato in tipo_recibido %}
    <p>{{ dato.nombre }}: {{ dato.cantidad }}</p>
    {% endfor %}
  </article>
</div>
{% endblock %}
{% block javascript %}
<script src="{{ asset('bundles/unahsgo/js/Chart.min.js') }}" type="text/javascript"></script>
<script type="text/javascript">
  var ctx = document.getElementById("flujo").getContext("2d");
  var data = {
    labels : ["Recibidos","Enviados"],
    datasets : [
      {
        fillColor : "rgba(220,220,220,0.5)",
        strokeColor : "rgba(220,220,220,1)",
        pointColor : "rgba(220,220,220,1)",
        pointStrokeColor : "#fff",
        data : [{{ recibidos }}, {{ enviados }}]
      },
    ]
  };
  var eficiencia = new Chart(ctx).Bar(data, {
    scaleOverride : true,
    scaleSteps : Math.max({{ recibidos }}, {{ enviados }}) + 1,
    scaleStepWidth : 1,
    scaleStartValue : 0
  });
  
  var ctx = document.getElementById("eficiencia").getContext("2d");
  data = [
    {
      value: {{ respondidos }},
      label: 'Respondidos: ' + {{ respondidos }},
      labelColor : 'white',
      color: '#'+Math.floor(Math.random()*16777215).toString(16)
    },
    {
      value: {{ noRespondidos }},
      label: 'No Respondidos: ' + {{ noRespondidos }},
      labelColor : 'white',
      color: '#'+Math.floor(Math.random()*16777215).toString(16)
    }
  ]
  /*var data = {
    labels : ["Respondidos","No Respondidos"],
    datasets : [
      {
        fillColor : "rgba(220,220,220,0.5)",
        strokeColor : "rgba(220,220,220,1)",
        pointColor : "rgba(220,220,220,1)",
        pointStrokeColor : "#fff",
        data : [{{ respondidos }}, {{ noRespondidos }}]
      },
    ]
  };*/
  var eficiencia = new Chart(ctx).Pie(data);
  
  var ctx = document.getElementById("dependencias").getContext("2d");
  /*var data = {
    labels : [{% for dato in emisor %} "{{ dato.nombre }}", {% endfor %}],
    datasets : [
      {
        fillColor : "rgba(220,220,220,0.5)",
        strokeColor : "rgba(220,220,220,1)",
        pointColor : "rgba(220,220,220,1)",
        pointStrokeColor : "#fff",
        data : [{% for dato in emisor %} {{ dato.cantidad }}, {% endfor %}]
      },
    ]
  };*/
  data = [
    {% for dato in emisor %}
    {
      value: {{ dato.cantidad }},
      label: '{{ dato.nombre }}',
      labelColor : 'white',
      color: '#'+Math.floor(Math.random()*16777215).toString(16)
    },
    {% endfor %}
    {
      value: 0
    }
  ]
  var emisor = new Chart(ctx).Pie(data);
  
  var ctx = document.getElementById("tipo").getContext("2d");
  var data = {
    labels : [{% for dato in tipo %} "{{ dato.nombre }}", {% endfor %}],
    datasets : [
      {
        fillColor : "rgba(220,220,220,0.5)",
        strokeColor : "rgba(220,220,220,1)",
        pointColor : "rgba(220,220,220,1)",
        pointStrokeColor : "#fff",
        data : [{% for dato in tipo %} {{ dato.cantidad }}, {% endfor %}]
      },
    ]
  };
  var tipo = new Chart(ctx).Bar(data, {
    scaleOverride : true,
    scaleSteps : Math.max({% for dato in tipo %} {{ dato.cantidad }}, {% endfor %} 1) + 1,
    scaleStepWidth : 1,
    scaleStartValue : 0
  });
  
  var ctx = document.getElementById("tipo-recibido").getContext("2d");
  var data = {
    labels : [{% for dato in tipo_recibido %} "{{ dato.nombre }}", {% endfor %}],
    datasets : [
      {
        fillColor : "rgba(220,220,220,0.5)",
        strokeColor : "rgba(220,220,220,1)",
        pointColor : "rgba(220,220,220,1)",
        pointStrokeColor : "#fff",
        data : [{% for dato in tipo_recibido %} {{ dato.cantidad }}, {% endfor %}]
      },
    ]
  };
  var tipo_recibido = new Chart(ctx).Bar(data, {
    scaleOverride : true,
    scaleSteps : Math.max({% for dato in tipo_recibido %} {{ dato.cantidad }}, {% endfor %} 1) + 1,
    scaleStepWidth : 1,
    scaleStartValue : 0
  });
</script>
{% endblock %}